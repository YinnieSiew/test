{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}

<style>
    body {
        background-color: #f2eadf;
        font-family: 'Times New Roman', serif;
        color: rgb(78, 68, 57);
    }

    .about-section {
        max-width: 900px;
        margin: 60px auto;
        padding: 40px;
        background-color: #fff7ec;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        display: flex;
        align-items: center;
        gap: 30px;
    }

    .text {
        flex: 1;
        text-align: left;
    }

    h2 {
        color: rgb(78, 68, 57);
    }

    h3 {
        margin-top: 10px;
        font-size: 20px;
        color: #4E4439;
    }

    .photo {
        position: relative;
        width: 350px;
        height: 450px;
        overflow: hidden;
    }

    .photo img {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 10px;
        object-fit: cover;
    }

    #contest-calendar {
        max-width: 900px;
        /* Same width as .about-section */
        margin: 60px auto;
        /* Same spacing */
        padding: 40px;
        background: #fff7ec;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    }

    #calendar {
        width: 100%;
        height: 700px;
        display: block;
        background-color: #fff7ec;
        padding: 20px;
        font-family: 'Times New Roman', Times, serif;
    }

    .fc-button {
        background-color: #6b4f2f !important;
        color: white !important;
        border: none !important;
    }

    .fc-button:hover {
        background-color: #8d6c45 !important;
    }

    .fc-prev-button, .fc-next-button {
        background-color: #c79058 !important;
        color: white !important;
    }

    .fc-prev-button:hover, .fc-next-button:hover {
        background-color: #9c6732 !important;
    }

    .fc-event {
        background-color: #812d9b !important; /* Match the card background */
        border: none;
        color: white !important;
        font-weight: bold !important;
    }

    .fc-event:hover {
        background-color: #a665b9 !important;
        color: white !important;
    }

    .fc-event * {
        color: white !important;
        font-weight: bold;
    }

    .fc-daygrid-event {
        width: 100% !important;
        height: 100% !important;
        display: flex !important;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 5px;
    }
    
    footer {
        background-color: #5C4033;
        color: white;
        text-align: center;
        padding: 10px;
        bottom: 0;
        width: 100%;
        margin-top: 60px;
    }

    footer p {
        margin: 5px 0;
        font-size: 16px;
    }

    .latest-stories-container {
        align-items: center;
        max-width: 450px;
        margin: 40px;
        margin-left: 20%;
        padding: 20px;
        background-color: #fff7ec;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    }

    .latest-stories-container a {
        font-size: 18px;
        margin-top: 10px;
        font-weight: bold;
        color: rgb(120, 100, 80);
        font-family: "Times New Roman";
    }

    .latest-stories-grid {
        display: flex;
        flex-direction: column;
        gap: 15px;
        max-width: 900px;
        margin: auto;
        align-items: center;
    }  

    .latest-story-box {
        width: 280px;
        border-radius: 10px;
        padding: 15px;
        background-color: #fff7ec;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        text-align: center;
    }

    .latest-story-box img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        border-radius: 8px;
        transition: transform 0.3s ease-in-out;
        cursor: pointer;
    }

    .latest-story-title {
        font-size: 18px;
        font-weight: bold;
        margin-top: 10px;
        color: rgb(78, 68, 57);
        font-family: "Times New Roman";
    }

    .latest-story-title a {
        text-decoration: none;
        color: rgb(120, 100, 80);
    }

    .latest-story-box img:hover {
        transform: scale(1.05);
    }

    .view-stories-link {
        text-align: center;
        margin-top: 5px;
    }

    .view-stories-link a {
        font-size: 20px;
        font-family: 'Times New Roman', serif;
        color: rgb(120, 100, 80);
        font-weight: bold;
        text-decoration: none;
        transition: color 0.3s ease, transform 0.3s ease;
        display: inline-block;
        cursor: pointer;
    }

    .view-stories-link a:hover {
        background-color: transparent;
        transform: scale(1.1);
        text-decoration: underline;
    }

</style>

<head>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
</head>

<div class="about-section">
    <div class="text">
        <h2 style="text-align: center; margin-bottom: 25px;"><b>üêæ About MeowMeowU üêæ</b></h2>
        <p>
            Welcome to MeowMeowU, a vibrant community where students celebrate campus cats‚ùï<br />
            Share photos, create feline profiles, and interact with fellow cat lovers.
        </p>
        <p>
            Whether you're naming a new furry friend, voting in cat-themed contests, or simply enjoying adorable posts ‚Äî
            this platform brings students together through their shared love of cats. üíï
        </p>
        <p>
            Help make the campus a better place for our feline companions!
            Earn badges, participate in the community, and challenge yourself with fun quizzes. üñä
            Connect with fellow cat enthusiasts and contribute to a cat-friendly environment. üåü
        </p>
    </div>

    <div class="photo">
        <img src="static/Images/home.image.jpeg" alt="Cat 1">
    </div>
</div>

<hr>

<section id="contest-calendar">
    <h2 style="text-align: center; margin-bottom: 25px;"><b>üìÖ Upcoming & Ongoing Contests</b></h2>
    <div id="calendar"></div>
</section>

<hr>

<div class="latest-stories-container">
    <h2 style="font-weight: bold; color: rgb(78, 68, 57); font-family: Times New Roman; padding-bottom: 10px; text-align: center;">üìñLatest Cat Stories</h2>
    <div class="latest-stories-grid">
        {% for story in stories %}
        <div class="latest-story-box">
            <a href="{{ url_for('auth.view_story', story_id=story.id) }}">
                <img src="{{ url_for('auth.uploaded_file', filename=story.image_filename) }}" alt="Story Image">
            </a>
            <h3 class="latest-story-title">
                <a href="{{ url_for('auth.view_story', story_id=story.id) }}">{{ story.caption }}</a>
            </h3>
        </div>
        {% endfor %}
    </div>
    <div class="view-stories-link">
        <a href="{{ url_for('auth.cat_story') }}">üììMore Cat Stories</a>
    </div>
</div>

<footer>
    <p>¬© 2025 MeowMeowU | All rights reserved.</p>
    <p>2510 CSP1123 3-07</p>
    <p>Instagram: @shyen_17 | @mingyenn__ | @yinnie_s </p>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        fetch('/api/contests') //Send request to get the list of contests in backend
            .then(response => response.json())
            .then(data => {
                console.log("Fetched Contests:", data);  //Debugging

                var formattedData = data.map(event => ({ //Transform the API data into a format that the Calendar understands
                    title: event.title,
                    start: event.start //Ensures the date is passed in 'YYYY-MM-DD' format
                }));

                var calendarEl = document.getElementById('calendar');
                var calendar = new FullCalendar.Calendar(calendarEl, { //Creates a new calendar instance
                    initialView: 'dayGridMonth',
                    events: formattedData, //Pass formatted contest data from your database
                    eventClick: function (info) {
                        alert('Contest: ' + info.event.title + '\nStart Date: ' + info.event.start);
                    }
                });
                calendar.render();
            });
    });
</script>

{% endblock %}